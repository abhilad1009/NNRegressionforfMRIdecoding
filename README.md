#Neural Network Regression for fMRI decoding

---

Code repository for [Neural Network Regression for fMRI decoding]()

##Requirements
---


*   Python 3.x
*   Tensorflow
*   Numpy
*   Matplotlib
*   H5py
*   Scipy
*   Sklearn
*   Pandas

##Data
---
The required data can be downloaded from the following links:

* [ImageNet validation set]()

* [fMRI data]()

##Setting up files
---
The data files should be places in structure given below:

    Project Folder
        |____ data
                |____fmri
                |     |____subject1.mat
                |     |____imageID_training.csv
                |     |____imageID_test.csv
                |
                |____TRAIN_IMG (training images corresponding to fmri)
                |
                |____TEST_IMG  (testing images corresponding to fmri)
                |
                |____GAN_TRAIN (validation set of imagenet)



##Usage
---
* Install all the mentioned requirements.

* Download necessary data from the given links and place them in given folder structure.

###Extracting VGG19 features

* Run the [vgg19_features.py]() file to extract necessary features. The extracted features are stored in [data]() folder with .h5 extension.

###Training image generating model

* Run [gan_model.py]() for training image generating model. After the script completes, the saved model can be found in saved_models folder.

* This can also be done in step-by-step manner by running the [gan_model.ipynb]() notebook. This is highy recommended for understanding and tinkering with the code.

###Training neural network decoder

* Runnig [decoder.py]() will train the decoder and show the images generated from test fmri data. The default values for decoder variables can be changes before running the script.

* This can also be done in step-by-step manner by running the [decoder.ipynb]() notebook. This is highy recommended for understanding and tinkering with the code.

###Results

The images generated by decoding test fmri data can be found in results folder.


